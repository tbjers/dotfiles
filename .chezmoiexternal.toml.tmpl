# -*-mode:toml-*- vim:ft=toml
# -*-mode:go-template-*- vim:ft=toml

# ~/.local/share/chezmoi/.chezmoiexternal.toml.tmpl
# =============================================================================
# {{ $osid := .osid }}{{ $arch := (eq .chezmoi.arch "amd64" | ternary "x86_64" .chezmoi.arch) }}
# Used to download external dependencies.{{- /*
#
# This file supports Go's text/template language. */}}

[".local/bin/zjstatus.wasm"]
    type = "file"
    url = "https://github.com/dj95/zjstatus/releases/latest/download/zjstatus.wasm"
    refreshPeriod = "24h"

{{ if or .codespaces (eq .osid "linux-wolfi") -}}
{{ else -}}

{{ $bat_version := (gitHubLatestRelease "sharkdp/bat").TagName -}}
[".local/bin/bat"]
    type = "archive-file"
    url = "https://github.com/sharkdp/bat/releases/download/{{ $bat_version }}/bat-{{ $bat_version }}-{{ $arch }}-unknown-{{ .chezmoi.os }}-gnu.tar.gz"
    executable = true
    refreshPeriod = "168h"
    path = "bat-{{ $bat_version }}-{{ $arch }}-unknown-{{ .chezmoi.os }}-gnu/bat"

{{ $yamlfmt_version := (gitHubLatestRelease "google/yamlfmt").TagName | replace "v" "" -}}
[".local/bin/yamlfmt"]
    type = "archive-file"
    url = "https://github.com/google/yamlfmt/releases/download/v{{ $yamlfmt_version }}/yamlfmt_{{ $yamlfmt_version }}_{{ .chezmoi.os | title }}_{{ $arch }}.tar.gz"
    executable = true
    refreshPeriod = "168h"
    path = "yamlfmt"

{{ $go_checksums := (index .golang.checksums .chezmoi.os) -}}
[".local/share/go"]
    type = "archive"
    url = "https://go.dev/dl/go{{ .golang.version }}.{{ .chezmoi.os }}-{{ .chezmoi.arch }}.tar.gz"
    refreshPeriod = "168h"
    exact = true
    stripComponents = 1
    [".local/share/go".checksum]
        sha256 = "{{ index $go_checksums .chezmoi.arch }}"

{{ $pop_version := (gitHubLatestRelease "charmbracelet/pop").TagName | replace "v" "" }}
[".local/bin/pop"]
    type = "archive-file"
    url = "https://github.com/charmbracelet/pop/releases/download/v{{ $pop_version }}/pop_{{ $pop_version }}_{{ .chezmoi.os | title }}_{{ $arch }}.tar.gz"
    executable = true
    refreshPeriod = "168h"
    path = "pop"

{{ $gh_version := (gitHubLatestRelease "cli/cli").TagName | replace "v" "" }}
[".local/bin/gh"]
    type = "archive-file"
    url = "https://github.com/cli/cli/releases/download/v{{ $gh_version }}/gh_{{ $gh_version }}_{{ .chezmoi.os }}_{{ .chezmoi.arch }}.tar.gz"
    executable = true
    refreshPeriod = "168h"
    stripComponents = 1
    path = "bin/gh"

{{ end -}}
